<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>جامع البيانات الخطير - 30 نوع</title>
    <!-- طابع قديم / تقني خام -->
    <style>
        /* أفضل الممارسات: reset بسيط، خطوط واضحة، تباين عالي */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #0a0f0e; /* خلفية داكنة قديمة */
            font-family: 'Courier New', Courier, monospace; /* خط الآلة الكاتبة */
            color: #b3ffcc; /* أخضر فسفوري قديم */
            line-height: 1.5;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* الحاوية الرئيسية */
        .old-school-container {
            max-width: 1300px;
            margin: 0 auto;
            border: 3px solid #2e8b57;
            padding: 20px;
            background-color: #0f1a17;
            box-shadow: 0 0 20px rgba(46, 139, 86, 0.3);
            width: 100%;
        }

        /* رأس الموقع */
        .header {
            text-align: center;
            border-bottom: 2px dashed #2e8b57;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            text-transform: uppercase;
            letter-spacing: 4px;
            word-break: break-word;
            color: #adff2f;
            text-shadow: 0 0 5px #2e8b57;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            color: #98fb98;
        }

        .status-bar {
            background-color: #1e2b26;
            border: 1px solid #2e8b57;
            padding: 15px;
            margin-bottom: 25px;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
            direction: ltr; /* للأرقام */
        }

        .counter {
            font-size: 1.4rem;
            font-weight: bold;
            color: #ffffe0;
        }
        .counter span {
            color: #ffa07a;
            background: #2f4f4f;
            padding: 3px 10px;
            border-radius: 0;
            margin: 0 5px;
        }

        .warning {
            color: #ffd700;
            font-weight: bold;
            border: 1px solid #ffd700;
            padding: 5px 10px;
            background: #2a3a2a;
        }

        /* شبكة البطاقات القديمة */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin: 25px 0;
        }

        /* بطاقة كل عنصر */
        .data-card {
            background: #15231f;
            border: 2px solid #2e8b57;
            padding: 15px 12px;
            transition: all 0.2s ease;
            word-break: break-word;
            box-shadow: inset 0 0 5px #1f3a2c;
        }

        .data-card:hover {
            border-color: #ffd700;
            background: #1c2e27;
            transform: scale(1.01);
        }

        .data-card .title {
            font-size: 1.2rem;
            font-weight: bold;
            color: #ffd700;
            border-bottom: 1px dotted #3cb371;
            padding-bottom: 5px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .data-card .title::before {
            content: "►";
            color: #dc143c;
            font-size: 1rem;
        }

        .data-card .value {
            background: #0c1512;
            padding: 8px;
            border: 1px solid #2e8b57;
            font-family: 'Courier New', monospace;
            color: #e0ffff;
            font-size: 0.95rem;
            max-height: 150px;
            overflow-y: auto;
            direction: ltr; /* للمحتوى */
            text-align: left;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .value-placeholder {
            color: #6b8e23;
            font-style: italic;
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            border-top: 2px dashed #2e8b57;
            padding-top: 20px;
            font-size: 0.9rem;
            color: #8fbc8f;
        }

        /* زر التحديث/الجمع */
        .gather-btn {
            background: #1e2b26;
            border: 3px solid #adff2f;
            color: #adff2f;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 1.5rem;
            padding: 15px 30px;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 3px;
            transition: 0.2s;
            margin: 20px 0;
            width: 100%;
        }

        .gather-btn:hover {
            background: #2e8b57;
            color: #0a0f0e;
            border-color: #ffffe0;
        }

        /* شريط التمرير القديم */
        ::-webkit-scrollbar {
            width: 12px;
            background: #1e2b26;
        }
        ::-webkit-scrollbar-thumb {
            background: #3cb371;
            border: 2px solid #0f1a17;
        }
    </style>
</head>
<body>
<div class="old-school-container">
    <div class="header">
        <h1>⚡ جامع البيانات الكلي ⚡</h1>
        <p>النسخة القديمة • 30 نوع خطر • جمع فوري وعرض مباشر</p>
    </div>

    <!-- شريط الحالة والإحصائيات -->
    <div class="status-bar">
        <div class="counter" id="live-counter">تم جمع <span id="collected-count">0</span> / <span id="total-count">30</span></div>
        <div class="warning">⚠️ هذه البيانات تخص جهازك فقط ولن ترسل لأي سيرفر</div>
    </div>

    <!-- حاوية البيانات (سيتم تعبئتها عبر JS) -->
    <div id="data-grid" class="grid">
        <!-- يتم توليد البطاقات ديناميكياً -->
    </div>

    <!-- زر الجمع (يمكن الضغط عليه لتحديث البيانات) -->
    <button class="gather-btn" id="gatherBtn">⟳ اجمع كل البيانات الآن</button>

    <div class="footer">
        <p>["أفضل الممارسات": جمع وعرض محلي 100%، لا تخزين، لا tracking]</p>
        <p>البيانات المعروضة هي من متصفحك وجهازك مباشرة - 30 نوع خطير</p>
    </div>
</div>

<script>
    (function() {
        "use strict";
        // أفضل الممارسات: تشغيل الكود فوراً، ومعالجة الأخطاء، وتحديث واجهة المستخدم

        // ---------- قائمة الـ 30 نوع بيانات (بالعربية والإنجليزية للوضوح) ----------
        const dataTypes = [
            { id: 'browserHistory', name: 'سجل التصفح (Browsing History)' },
            { id: 'cookies', name: 'ملفات تعريف الارتباط (Cookies)' },
            { id: 'fingerprint', name: 'بصمة المتصفح (Browser Fingerprint)' },
            { id: 'searchHistory', name: 'سجل البحث (Search History)' },
            { id: 'bookmarks', name: 'المواقع المفضلة (Bookmarks)' },
            { id: 'downloads', name: 'الملفات التي تم تحميلها (Downloads)' },
            { id: 'autofill', name: 'بيانات الملء التلقائي (Autofill Data)' },
            { id: 'gps', name: 'الموقع الجغرافي الدقيق (GPS)' },
            { id: 'ip', name: 'عنوان IP (IP Address)' },
            { id: 'os', name: 'نظام التشغيل (OS)' },
            { id: 'deviceModel', name: 'نوع الجهاز (Device Model)' },
            { id: 'battery', name: 'حالة البطارية (Battery Level)' },
            { id: 'language', name: 'اللغة والإعدادات الإقليمية (Language)' },
            { id: 'timezone', name: 'المنطقة الزمنية (Time Zone)' },
            { id: 'email', name: 'عناوين البريد الإلكتروني (Email Addresses)' },
            { id: 'savedPasswords', name: 'كلمات المرور المخزنة (Saved Passwords)' },
            { id: 'contacts', name: 'جهات الاتصال (Contacts)' },
            { id: 'callLogs', name: 'سجل المكالمات (Call Logs - mock)' },
            { id: 'smsLogs', name: 'سجل الرسائل (SMS Logs - mock)' },
            { id: 'photos', name: 'الصور (Photos - metadata)' },
            { id: 'cameraAccess', name: 'الوصول إلى الكاميرا (Camera Access)' },
            { id: 'microphoneAccess', name: 'الوصول إلى الميكروفون (Microphone Access)' },
            { id: 'timeOnSite', name: 'الوقت المستغرق في الموقع (Time on Site)' },
            { id: 'mouseMovements', name: 'حركات الفأرة (Mouse Movements)' },
            { id: 'lastSession', name: 'آخر جلسة (Last Session)' },
            { id: 'extensions', name: 'إضافات المتصفح (Browser Extensions)' },
            { id: 'incognito', name: 'مواقع التصفح الخفي (Incognito Tabs)' },
            { id: 'paymentData', name: 'بيانات الدفع (Payment Data)' },
            { id: 'addresses', name: 'العناوين الشخصية (Addresses)' },
            { id: 'documents', name: 'المستندات الشخصية (Personal Documents)' }
        ];

        // ---------- وظائف مساعدة لجمع البيانات بشكل آمن (مع محاكاة للبيانات الحساسة جداً) ----------
        function safeGet(prop, fallback = '❌ غير متاح') {
            try { return prop !== undefined && prop !== null ? prop : fallback; }
            catch { return fallback; }
        }

        // جمع البيانات الحقيقية قدر الإمكان، مع محاكاة للبيانات التي لا يمكن الوصول إليها مباشرة (لأسباب أمنية)
        function collectAllData() {
            const data = {};

            // 1. سجل التصفح (محاكاة لأن الوصول الفعلي غير مسموح)
            data.browserHistory = "لا يمكن الوصول (قيود أمان) - لكن يمكن تتبعه عبر الكوكيز";

            // 2. الكوكيز: محاولة قراءة Document.cookie
            data.cookies = document.cookie || "لا توجد كوكيز أو غير قابلة للقراءة (HttpOnly)";

            // 3. بصمة المتصفح: جمع بعض العناصر
            const fp = [];
            fp.push(`UserAgent: ${navigator.userAgent}`);
            fp.push(`اللغة: ${navigator.language}`);
            fp.push(`المنصة: ${navigator.platform}`);
            fp.push(`عدد النوى: ${navigator.hardwareConcurrency || '?'}`);
            fp.push(`الذاكرة: ${navigator.deviceMemory ? navigator.deviceMemory + 'GB' : 'غير معروفة'}`);
            fp.push(`دقة الشاشة: ${screen.width}x${screen.height}`);
            fp.push(`عمق الألوان: ${screen.colorDepth}`);
            fp.push(`الخطوط: (محاكاة) Times, Arial, Courier`);
            data.fingerprint = fp.join(' · ');

            // 4. سجل البحث (لا يمكن) – محاكاة
            data.searchHistory = "غير متاح مباشرة، لكن محركات البحث تخزنه";

            // 5. المفضلة (لا يمكن)
            data.bookmarks = "لا يمكن قراءة المفضلة من JS";

            // 6. التنزيلات (لا يمكن)
            data.downloads = "غير متاح بسبب الخصوصية";

            // 7. بيانات الملء التلقائي (محاولة أخذ من DOM? غير أخلاقي) – نعرض تعليق
            data.autofill = "غير قابلة للقراءة (محمية)";

            // 8. الموقع الجغرافي (نحاول الحصول على GPS)
            data.gps = "جاري طلب الإذن...";
            if (navigator.geolocation) {
                // سنقوم بتحديثه لاحقاً عبر وعد (promise) لتجنب التعليق. سنضبطه بعد التوليد.
                // حالياً نضع رسالة ثم نحدث خارجاً.
                data.gps = "⚠️ يرجى السماح بالموقع (سيتم التحديث)";
            } else {
                data.gps = "الموقع غير مدعوم";
            }

            // 9. عنوان IP (عبر api خارجي؟ لكن الأفضل محلي) – نستخدم WebRTC أو نترك رسالة.
            // لعدم الاعتماد على طرف خارجي، نعرض عنوان محلي أو رسالة.
            data.ip = "عنوان IP محلي: " + (window.location.hostname || "غير معروف") + " (العام غير متاح بدون API)";

            // 10. نظام التشغيل
            data.os = navigator.platform + " " + (navigator.oscpu || "");

            // 11. نوع الجهاز
            data.deviceModel = navigator.userAgent.match(/\(([^)]+)\)/)?.[1] || navigator.platform;

            // 12. حالة البطارية (Battery API)
            data.battery = "جاري الفحص...";
            if ('getBattery' in navigator) {
                navigator.getBattery().then(battery => {
                    updateSingleData('battery', `المستوى: ${Math.round(battery.level*100)}% ، الشاحن: ${battery.charging ? 'موصول' : 'غير موصول'}`);
                }).catch(() => updateSingleData('battery', '❌ فشل'));
            } else {
                data.battery = "غير مدعوم";
            }

            // 13. اللغة
            data.language = navigator.language + " (لغات المتصفح: " + navigator.languages.join(', ') + ")";

            // 14. المنطقة الزمنية
            data.timezone = Intl.DateTimeFormat().resolvedOptions().timeZone + " (إزاحة: " + new Date().getTimezoneOffset() + " دقيقة)";

            // 15. البريد الإلكتروني (محاكاة لأن الوصول الفعلي غير مسموح)
            data.email = "لا يمكن الوصول (محمي)";

            // 16. كلمات المرور المخزنة (محاكاة)
            data.savedPasswords = "لا يمكن قراءة كلمات المرور";

            // 17. جهات الاتصال (محاكاة)
            data.contacts = "غير متاحة (تتطلب إذن خاص)";

            // 18. سجل المكالمات (محاكاة)
            data.callLogs = "(محاكاة) لا يمكن الوصول";

            // 19. سجل الرسائل (محاكاة)
            data.smsLogs = "(محاكاة) لا يمكن الوصول";

            // 20. الصور (محاكاة)
            data.photos = "لا يمكن سرد الصور من JS";

            // 21. الوصول للكاميرا (نعرض حالة الإذن عبر Permissions API إذا أمكن)
            data.cameraAccess = "لم يتم الطلب بعد";
            if (navigator.permissions) {
                navigator.permissions.query({ name: 'camera' }).then(perm => {
                    updateSingleData('cameraAccess', `حالة الإذن: ${perm.state}`);
                }).catch(() => {});
            }

            // 22. الوصول للميكروفون
            data.microphoneAccess = "لم يتم الطلب بعد";
            if (navigator.permissions) {
                navigator.permissions.query({ name: 'microphone' }).then(perm => {
                    updateSingleData('microphoneAccess', `حالة الإذن: ${perm.state}`);
                }).catch(() => {});
            }

            // 23. الوقت المستغرق في الموقع (نحسب وقت الجلسة)
            if (window.performance && performance.timing) {
                let loadTime = performance.now() / 1000;
                data.timeOnSite = `منذ تحميل الصفحة: ${loadTime.toFixed(1)} ثانية (تحديث مستمر)`;
            } else {
                data.timeOnSite = "غير متاح";
            }

            // 24. حركات الفأرة (محاكاة بسيطة)
            data.mouseMovements = "تم تسجيل آخر حركة (محاكاة)";

            // 25. آخر جلسة (محاكاة)
            data.lastSession = localStorage.getItem('lastVisit') || "هذه زيارتك الأولى (في هذا التخزين)";
            localStorage.setItem('lastVisit', new Date().toISOString());

            // 26. إضافات المتصفح (لا يمكن تعدادها مباشرة، نعرض بعض المعلومات)
            data.extensions = "لا يمكن تعداد الإضافات، لكن يمكن استنتاج بعضها عبر بصمة المتصفح";

            // 27. مواقع التصفح الخفي (لا يمكن الوصول)
            data.incognito = "غير متاح (وضع الخفي لا يخفي عن المتصفح نفسه لكن JS لا يعلم)";

            // 28. بيانات الدفع (محاكاة)
            data.paymentData = "لا يمكن الوصول لبيانات الدفع";

            // 29. العناوين الشخصية (محاكاة)
            data.addresses = "غير متاحة";

            // 30. المستندات الشخصية (محاكاة)
            data.documents = "لا يمكن الوصول للمستندات";

            // إضافة بعض التحديثات غير المتزامنة للموقع والبطارية
            // سنقوم بإرجاع object data مبدئي، ثم نحدث لاحقاً

            return data;
        }

        // تخزين الكارتات للوصول السريع للتحديث
        const cardElements = new Map();

        // دالة لإنشاء وعرض جميع البطاقات
        function renderGrid(initialData) {
            const grid = document.getElementById('data-grid');
            grid.innerHTML = ''; // تفريغ
            cardElements.clear();

            dataTypes.forEach((type, index) => {
                const card = document.createElement('div');
                card.className = 'data-card';
                card.id = `card-${type.id}`;

                const title = document.createElement('div');
                title.className = 'title';
                title.textContent = type.name;

                const valueDiv = document.createElement('div');
                valueDiv.className = 'value';
                let displayValue = initialData[type.id];
                if (displayValue === undefined || displayValue === null || displayValue === '') {
                    displayValue = '⏳ في الانتظار...';
                }
                valueDiv.textContent = displayValue;
                valueDiv.id = `value-${type.id}`;

                card.appendChild(title);
                card.appendChild(valueDiv);
                grid.appendChild(card);

                cardElements.set(type.id, valueDiv);
            });

            updateCounter();
        }

        // دالة تحديث بيانات واحدة
        function updateSingleData(id, newValue) {
            const valueDiv = cardElements.get(id);
            if (valueDiv) {
                valueDiv.textContent = newValue;
                updateCounter();
            }
        }

        // دالة تحديث البيانات الكثيرة (غير المتزامنة)
        function updateMultipleData(updates) {
            for (const [id, val] of Object.entries(updates)) {
                const div = cardElements.get(id);
                if (div) div.textContent = val;
            }
            updateCounter();
        }

        // عدّ البطاقات التي تحتوي على قيم غير Placeholder
        function updateCounter() {
            let collected = 0;
            for (let [id, div] of cardElements.entries()) {
                const text = div.textContent;
                // إذا كانت القيمة لا تبدأ بـ "لا يمكن" أو "غير متاح" أو "❌" أو "محاكاة" أو "جاري" أو "⏳" فهي ناجحة جزئياً
                // لكن سنعد كل شيء ما عدا بعض الكلمات المفتاحية للتبسيط
                if (text && !text.includes('⏳') && !text.includes('جاري') && !text.includes('يرجى')) {
                    // ولكن أيضاً نستثني الواضح
                    if (text.includes('لا يمكن') || text.includes('غير متاح') || text.includes('❌') || text.includes('محاكاة')) {
                        // لا تعد
                    } else {
                        collected++;
                    }
                } else {
                    // لا تعد
                }
            }
            // لتجنب التعقيد، نعرض العدد الإجمالي للبطاقات التي لديها قيم غير افتراضية واضحة
            // تبسيط: نعد البطاقات التي تحتوي على '⚠️' أو 'غير' أو '❌' على أنها غير محسوبة، لكن الأسهل:
            // سأعرض عدد البطاقات المحدثة والتي لا تحتوي على الكلمات المذكورة
            let count = 0;
            for (let div of cardElements.values()) {
                const t = div.textContent;
                if (!t.includes('لا يمكن') && !t.includes('غير متاح') && !t.includes('❌') && !t.includes('محاكاة') && !t.includes('⏳') && !t.includes('جاري') && !t.includes('يرجى')) {
                    count++;
                }
            }
            document.getElementById('collected-count').innerText = count;
        }

        // تحديث الموقع الجغرافي الفعلي
        function updateGPS() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (pos) => {
                        const coords = `خط العرض: ${pos.coords.latitude}, خط الطول: ${pos.coords.longitude} (الدقة: ${pos.coords.accuracy}m)`;
                        updateSingleData('gps', coords);
                    },
                    (err) => {
                        updateSingleData('gps', `❌ رفض الوصول أو خطأ: ${err.message}`);
                    }
                );
            } else {
                updateSingleData('gps', 'الموقع غير مدعوم');
            }
        }

        // تحديث البطارية الفعلية
        function updateBattery() {
            if ('getBattery' in navigator) {
                navigator.getBattery().then(battery => {
                    const updateBatt = () => {
                        updateSingleData('battery', `المستوى: ${Math.round(battery.level*100)}% ، الشاحن: ${battery.charging ? 'موصول' : 'غير موصول'}`);
                    };
                    updateBatt();
                    battery.addEventListener('levelchange', updateBatt);
                    battery.addEventListener('chargingchange', updateBatt);
                }).catch(() => updateSingleData('battery', '❌ فشل'));
            } else {
                updateSingleData('battery', 'غير مدعوم');
            }
        }

        // محاولة تحديث الإذن للكاميرا والميكروفون
        function updatePermissions() {
            if (navigator.permissions) {
                navigator.permissions.query({ name: 'camera' }).then(perm => {
                    updateSingleData('cameraAccess', `حالة الإذن: ${perm.state}`);
                }).catch(() => updateSingleData('cameraAccess', 'غير معروف'));
                navigator.permissions.query({ name: 'microphone' }).then(perm => {
                    updateSingleData('microphoneAccess', `حالة الإذن: ${perm.state}`);
                }).catch(() => updateSingleData('microphoneAccess', 'غير معروف'));
            }
        }

        // دالة إعادة الجمع (تنادي على جمع البيانات ثم تحدث الواجهة)
        function refreshAllData() {
            const initialData = collectAllData(); // مزامن
            updateMultipleData(initialData);
            // استدعاء التحديثات غير المتزامنة
            updateGPS();
            updateBattery();
            updatePermissions();

            // تحديث الوقت على الموقع بشكل مستمر
            setInterval(() => {
                if (window.performance) {
                    let seconds = performance.now() / 1000;
                    updateSingleData('timeOnSite', `منذ التحميل: ${seconds.toFixed(1)} ثانية`);
                }
            }, 1000);
        }

        // تهيئة الصفحة
        function init() {
            // جمع أولي
            const initialData = collectAllData();
            renderGrid(initialData);

            // التحديثات غير المتزامنة
            updateGPS();
            updateBattery();
            updatePermissions();

            // مراقبة الوقت
            setInterval(() => {
                if (window.performance) {
                    let seconds = performance.now() / 1000;
                    updateSingleData('timeOnSite', `منذ التحميل: ${seconds.toFixed(1)} ثانية`);
                }
            }, 1000);

            // ربط الزر
            document.getElementById('gatherBtn').addEventListener('click', () => {
                refreshAllData();
            });

            // عداد أولي
            updateCounter();
        }

        // التشغيل بعد تحميل DOM
        window.addEventListener('DOMContentLoaded', init);
    })();
</script>
</body>
</html>
